---
layout: post
title: Git学习笔记
date: 2021-08-14
author: zxl19
tags: [GitHub, Note]
comments: true
toc: true
pinned: false
---

我的Git学习笔记。

<!-- more -->

## 基本概念

1. **工作目录**：持有实际文件；
2. **暂存区（Index）**：缓存区域，临时保存改动；
3. **HEAD**：指向最后一次提交的结果；

## 常用命令

1. 创建新仓库：

    ```shell
    # 在仓库文件夹中
    git init
    ```

2. 检出仓库：

    ```shell
    # 创建一个本地仓库的克隆版本
    git clone /path/to/repository
    # 创建远端服务器上仓库的克隆版本
    git clone username@host:/path/to/repository
    ```

3. 添加和提交：

    ```shell
    # 添加单个文件到暂存区
    git add <filename>
    # 添加所有文件到暂存区
    git add *
    # 提交改动到HEAD
    git commit -m "代码提交信息"
    ```

4. 推送改动：

    ```shell
    # 提交改动到远端仓库的master分支
    git push origin master
    ```

    ```shell
    # 显示远程服务器
    git remote -v
    # 连接仓库到远程服务器
    git remote add origin <server>
    # 删除远程服务器
    git remote remove origin
    ```

5. 分支：将特性开发绝缘，默认分支为`master`或`main`：

    ```shell
    # 新建分支并切换
    git checkout -b <branch>
    # 切换回主分支
    git checkout master
    # 删除分支
    git branch -d <branch>
    # 推送分支到远端仓库，使其对他人可见
    git push origin <branch>
    ```

6. 更新与合并：

    ```shell
    # 更新本地仓库至最新改动
    # 相当于git fetch + git merge
    git pull
    # 合并其他分支到当前分支
    git merge <branch>
    # 合并冲突后手动添加文件到暂存区
    git add <filename>
    # 预览差异
    git diff <source_branch> <target_branch>
    ```

7. 标签：

    ```shell
    # 创建标签
    git tag 1.0.0 [ID前十位]
    # 获取提交ID
    git log
    ```

8. 替换本地改动：

    ```shell
    # 使用HEAD中的最新内容替换掉工作目录中的文件
    # 已添加到暂存区的改动以及新文件都不会受到影响
    git checkout -- <filename>
    # 丢弃本地的所有改动与提交
    # 到服务器上获取最新的版本历史并将本地主分支指向它
    git fetch origin
    git reset --hard origin/master
    ```

9. 实用小贴士：

    - 内建的图形化git：

        ```shell
        gitk
        ```

    - 彩色的git输出：

        ```shell
        git config color.ui true
        ```

    - 显示历史记录时，每个提交的信息只显示一行：

        ```shell
        git config format.pretty oneline
        ```

    - 交互式添加文件到暂存区：

        ```shell
        git add -i
        ```

## 工作流程

1. 克隆远程仓库到本地：

    ```shell
    git clone username@host:/path/to/repository
    ```

2. 创建个人分支；

    - 新建分支：

        ```shell
        git checkout -b <branch> origin/master
        ```

    - 切换分支：

        ```shell
        git branch -a
        git checkout <branch>
        ```

3. 本地修改，提交：

    ```shell
    git add *
    git commit -m "代码提交信息"
    ```

    ```shell
    # 查看工作区状态
    git status
    ```

4. 拉取远程仓库更新到本地：

    - 远程的主分支：

        ```shell
        git pull origin master
        ```

    - 远程的个人分支：

        ```shell
        git pull
        ```

5. 在本地合并远程更新并测试；
6. 推送本地修改到远程个人分支：

    ```shell
    git push origin <branch>
    ```

## 使用技巧

### `.gitignore`文件

用于说明哪些文件或文件夹不需要添加到版本管理中。

GitHub官方提供了模板：[github/gitignore](https://github.com/github/gitignore)，可根据实际情况选择使用。

### `.gitkeep`文件

用于添加空文件夹到版本管理中。

### `.gitmodules`文件

用于记录仓库子模块的信息。

1. 添加子模块，注意使用相对路径，可以指定子模块的分支，会自动生成`.gitmodules`文件：

    ```shell
    git submodule add username@host:/path/to/repository /relative/path/to/submodule -b <branch>
    ```

    `.gitmodules`文件示例：

    ```text
    [submodule "/relative/path/to/submodule"]
        path = /relative/path/to/submodule
        url = username@host:/path/to/repository
        branch = <branch>
    ```

2. 在克隆远程仓库时添加`--recursive`循环克隆子模块：

    ```shell
    git clone username@host:/path/to/repository --recursive
    ```

3. 如果远程仓库已克隆完成，则需要单独克隆子模块：

    ```shell
    git submodule init
    git submodule update
    ```

## 参考

1. [Git教程-菜鸟教程](https://www.runoob.com/git/git-tutorial.html)
2. [Git简明指南](https://www.runoob.com/manual/git-guide/)
3. [Git五分钟教程](https://www.runoob.com/w3cnote/git-five-minutes-tutorial.html)
4. [.gitignore-简书](https://www.jianshu.com/p/699ed86028c2)
5. [git的ignore文件在c++下的编写-CSDN博客](https://blog.csdn.net/dong_beijing/article/details/79860967)
6. [什么是.gitkeep？-CSDN博客](https://blog.csdn.net/qq_37164975/article/details/106131919)
7. [Git子仓库深入浅出-那我懂你意思了的文章-知乎](https://zhuanlan.zhihu.com/p/100214931)
8. [git子仓库(submodule)操作-CSDN博客](https://blog.csdn.net/whuzhang16/article/details/120182063)
9. [.gitmodules-Stack Overflow](https://stackoverflow.com/questions/24777973/adding-git-submodules-automatically-gitmodules)
10. [--recursive-博客园](https://www.cnblogs.com/love-zf/p/13192734.html)
